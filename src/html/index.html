<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NMPDE Project: Non-linear cardiac mechanics: Non-linear cardiac mechanics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NMPDE Project: Non-linear cardiac mechanics
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Non-linear cardiac mechanics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The problem entails solving the partial differential equation concerning the contraction of the left ventricle when a force acts on the internal surface of the ventricle, known as the Endocardium. We model the acting forces as pressure without considering how the force is generated. Our modeling strategy follows a bottom-up approach: initially, we employ a simplified geometry and basic mathematical model, making assumptions about material properties. Subsequently, we refine the model by incorporating a more intricate formulation that accounts for the material properties. This testing methodology is inspired by the approach outlined <a href="https://pubmed.ncbi.nlm.nih.gov/26807042/">here</a>.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Constructive law: Guccione</h1>
<p>This section covers the finite element solver for materials that follow the <a href="https://pubmed.ncbi.nlm.nih.gov/8550635/">Guccioneâ€™s Law</a>.</p>
<p>An abstract base solver class <code><a class="el" href="classBaseSolverGuccione.html" title="Abstract class representing a base solver for non linear cardiac mechanics by using the isotropic or ...">BaseSolverGuccione</a></code> has been introduced as a base line starting point for each mesh test that we have run. This is a complete solver except for the boundaries initialization which must occur in any derived class as every problem is different.</p>
<p>The base class takes in account a pressure component that pushes on <em><b>x</b></em> boundaries, referred as Newmann boundaries. If your problem does not follow this pattern, please <em><b>override</b></em> all the needed implementations (this might the <code>assemble</code> method).</p>
<p>Dirichlet boundaries condition values are assigned in the derived class.</p>
<p><code><a class="el" href="classBaseSolverGuccione.html" title="Abstract class representing a base solver for non linear cardiac mechanics by using the isotropic or ...">BaseSolverGuccione</a></code>'s extension is a trivial task in order to create custom tests (e.g. <code>SlabCubicGuccione</code>).</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Constructive law: New Hook</h1>
<p>This section covers the finite element solver for materials that follow the New Hook law.</p>
<p>An abstract base solver class <code><a class="el" href="classBaseSolverNewHook.html" title="Abstract class representing a base solver for non linear cardiac mechanics by using the New Hook cons...">BaseSolverNewHook</a></code> has been introduced as a base line starting point for each mesh test that we have run. This is a complete solver except for the boundaries initialization which must occur in any derived class as every problem is different.</p>
<p>The base class takes in account a pressure component that pushes on <em><b>x</b></em> boundaries, referred as Newmann boundaries. If your problem does not follow this pattern, please <em><b>override</b></em> all the needed implementations (this might the <code>assemble</code> method).</p>
<p>Dirichlet boundaries condition values are assigned in the derived class.</p>
<p><code><a class="el" href="classBaseSolverNewHook.html" title="Abstract class representing a base solver for non linear cardiac mechanics by using the New Hook cons...">BaseSolverNewHook</a></code>'s extension is a trivial task in order to create custom tests (e.g. <code>SlabCubicNewHook</code>).</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Non Linear Solver</h1>
<p>As the cardiac problem is non linear, we have employed the <a href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton method</a>. The Jacobian matrix has been created by using <code>dealii</code> built-in <a href="https://www.dealii.org/current/doxygen/deal.II/group__auto__symb__diff.html">AD</a> packages.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Linear Solver</h1>
<p>Currently the following <em><b>iterative solvers</b></em> are supported in order to solve a single Newton iteration:</p><ul>
<li>[x] GMRES</li>
<li>[x] BiCGSTAB</li>
</ul>
<p><em><b>Preconditioners</b></em> available:</p><ul>
<li>[x] ILU</li>
<li>[x] SOR</li>
<li>[x] SSOR</li>
<li>[x] AMG</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Configuration file</h1>
<p>The single entry point for all run time and application specific parameters can be specified inside a configuration file called <code>your_config_name.prm</code>.</p>
<p>Changes can be tested without recompilation if they can be modified through the configuration file.</p>
<p>A mock configuration file for a Guccione constructive law problem: </p><div class="fragment"><div class="line">subsection LinearSolver</div>
<div class="line">  # Type of solver used to solve the linear system</div>
<div class="line">  set SolverType                = BiCGSTAB</div>
<div class="line"> </div>
<div class="line">  # Linear solver residual (scaled by residual norm)</div>
<div class="line">  set Residual                  = 1e-6</div>
<div class="line"> </div>
<div class="line">  # Linear solver iterations multiplier (to be multiplied to matrix size)</div>
<div class="line">  set MaxIteration              = 1.0</div>
<div class="line"> </div>
<div class="line">  # Preconditioner type</div>
<div class="line">  set PreconditionerType        = SSOR</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">subsection PolynomialDegree</div>
<div class="line">  # Degree of the polynomial for finite elements</div>
<div class="line">  set Degree                    = 1</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">subsection NewtonMethod</div>
<div class="line">  # Newton method residual</div>
<div class="line">  set Residual                  = 1e-6</div>
<div class="line"> </div>
<div class="line">  # Newton method max iterations</div>
<div class="line">  set MaxIterations             = 100</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">subsection Material</div>
<div class="line">  # b_f value of the material</div>
<div class="line">  set b_f                       = 8.0</div>
<div class="line"> </div>
<div class="line">  # b_t value of the material</div>
<div class="line">  set b_t                       = 2.0</div>
<div class="line"> </div>
<div class="line">  # b_fs value of the material</div>
<div class="line">  set b_fs                       = 4.0</div>
<div class="line"> </div>
<div class="line">  # C value of the material</div>
<div class="line">  set C                          = 2000.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">subsection Boundaries</div>
<div class="line">  # Dirichlet boundaries tags</div>
<div class="line">  set Dirichlet                  = 40</div>
<div class="line"> </div>
<div class="line">  # Newmann boundaries tags</div>
<div class="line">  set Newmann                    = 60</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">subsection Pressure</div>
<div class="line">  # External pressure value</div>
<div class="line">  set Value                      = 4.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">subsection Mesh</div>
<div class="line">  # Mesh file name</div>
<div class="line">  set File                      = /path/to/mesh</div>
<div class="line">end</div>
</div><!-- fragment --><p><b>Please be sure to add every subsection shown above as for missing sections, the program sets a default value that may lead to undefined results</b>.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Enviroenment</h1>
<p>This project is dependent on several c++ packages as:</p><ul>
<li><a href="https://www.dealii.org/current/doxygen/deal.II/">dealii</a> &gt;= v9.0</li>
<li><a href="https://www.open-mpi.org/">MPI</a> &gt;= v3.1</li>
<li><a href="https://www.boost.org/">BOOST</a> &gt;= v1.76.0</li>
</ul>
<p>To ease the configuration, a scientific docker enviroenment can be found <a href="https://hub.docker.com/r/pcafrica/mk">here</a>.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Compiling</h1>
<p>The following commands are dedicated for enviroenment with <code>mk</code> modules installed.</p>
<p>To build the executable, make sure you have loaded the needed modules with </p><div class="fragment"><div class="line">$ module load gcc-glibc dealii</div>
</div><!-- fragment --><p>Then run the following commands: </p><div class="fragment"><div class="line">$ mkdir build</div>
<div class="line">$ cd build</div>
<div class="line">$ cmake ..</div>
<div class="line">$ make</div>
</div><!-- fragment --><p>The executable will be created into <code>build</code>, and can be executed through </p><div class="fragment"><div class="line">$ mpirun -n x executable_name</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
Formatting</h1>
<p>All the source files are formatted by using <code>clang-format</code> with <code>LLVM</code> coding style. </p><div class="fragment"><div class="line">clang-format -i -style=LLVM --sort-includes your_file</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
